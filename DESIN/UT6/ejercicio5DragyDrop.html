<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ordenar numeros</title>
    <style>
        #tablero {
            width: 1000px;
            height: 75px;
            margin-top: 15px;
            display: flex;
            gap: 5px;
        }

        .casilla {
            width: 50px;
            height: 50px;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: rgb(57, 194, 57);
            gap: 1rem;
            border: 2px solid black;
            font-size: 2rem;
        }

        #tiempo {
            font-size: 1.5rem;
            margin-top: 10px;
        }
    </style>
</head>

<body>
    <button id="btnIniciar">Iniciar</button>

    <div id="tiempo">Tiempo: 0</div>

    <div id="tablero"></div>

    <script>
        const tablero = document.getElementById("tablero");
        const btnIniciar = document.getElementById("btnIniciar");
        const tiempoDiv = document.getElementById("tiempo");


        let juego = [];
        let solucion = [];
        let elementoIni = null;

        //Temporizador
        let segundos = 0;
        let intervalo = null;

        function iniciarTiempo() {
            segundos = 0;
            tiempoDiv.textContent = "Tiempo: 0";

            intervalo = setInterval(() => {
                segundos++;
                tiempoDiv.textContent = "Tiempo: " + segundos;
            }, 1000);
        }

        //Generar tablero
        function iniciarJuego() {

            tablero.innerHTML = "";  //Limpiar el juego
            juego = [];
            solucion = [];


            for (let i = 0; i < 10; i++) {
                const div = document.createElement("div");
                div.className = "casilla";

                const numero = Math.floor(Math.random() * 99 + 1);
                div.textContent = numero;
                div.dataset.valor = numero;
                div.draggable = "true";

                div.addEventListener("dragstart", iniciar);
                div.addEventListener("dragover", e => e.preventDefault());
                div.addEventListener("drop", soltar);
                div.addEventListener("dragend", finDrag);

                solucion.push(numero);
                juego.push(numero);

                tablero.appendChild(div);
            }

            solucion.sort((a, b) => a - b);
        }

        let posIni = 0;

        //DRAG & DROP
        function iniciar(e) {
            elementoIni = e.target;
            elementoIni.style.backgroundColor = "red";
        }

        function soltar(e, idDestino) {
            e.preventDefault();

            const elementoFin = e.target;

            //Intercambiar valores
            const aux = elementoIni.textContent;
            elementoIni.textContent = elementoFin.textContent;
            elementoFin.textContent = aux;

            //Actualizar el array
            const casillas = document.querySelectorAll(".casilla");
            for (let i = 0; i < casillas.length; i++) {
                juego[i] = parseInt(casillas[i].textContent);
            }

            //Comprobar si está ordenado
            const ordenado = juego.every((num, i) => num === solucion[i]);

            if (ordenado) {
                clearInterval(intervalo);
                alert("¡Correcto! Has ordenado los números.");
            }
        }

        function finDrag(e) {
            // Siempre vuelve a verde, aunque sueltes fuera
            e.target.style.backgroundColor = "rgb(57, 194, 57)";
        }


        btnIniciar.addEventListener("click", () => {
            clearInterval(intervalo);
            iniciarJuego();
            iniciarTiempo();
        })

    </script>
</body>

</html>